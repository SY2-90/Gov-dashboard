<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>공공기관 웹사이트 유지보수 대시보드</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* 부드러운 그림자 + 경계 라인 + 모던한 카드 효과 */
    .card {
      @apply bg-white rounded-xl shadow-md p-6 transition-shadow hover:shadow-xl;
    }
    /* 사이드바 스크롤 가능하도록 */
    aside {
      scrollbar-width: thin;
      scrollbar-color: #94a3b8 transparent;
    }
    aside::-webkit-scrollbar {
      width: 8px;
    }
    aside::-webkit-scrollbar-thumb {
      background-color: #94a3b8;
      border-radius: 4px;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

  <!-- 모바일용 사이드바 토글 버튼 -->
  <button
  id="sidebarToggle"
  class="md:hidden fixed top-4 left-4 z-30 p-3 bg-indigo-300 hover:bg-indigo-500 text-white rounded-lg shadow-lg transition"
  aria-label="메뉴 열기/닫기"
>
  <!-- 햄버거 아이콘 (3줄) -->
  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
  </svg>
</button>

  <div class="flex min-h-screen">

    <!-- 사이드바 -->
    <aside
      id="sidebar"
      class="fixed inset-y-0 left-0 w-64 bg-white border-r border-gray-200 shadow-sm flex flex-col overflow-y-auto transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out z-10"
    >
      <div class="p-6 text-2xl font-extrabold text-indigo-500 border-b border-gray-200 select-none">
        공공기관 유지보수
      </div>
      <nav class="flex flex-col p-4 space-y-2 text-gray-700">
          <a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-sky-100 hover:text-sky-700 transition duration-300 font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7m-9 2v6m4 0v-6m5 6v-7a2 2 0 00-2-2h-3.5a2 2 0 00-2 2v7" />
            </svg>
            홈
          </a>
          <a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-sky-100 hover:text-sky-700 transition duration-300 font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
            </svg>
            사이트 목록
          </a>
          <a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-sky-100 hover:text-sky-700 transition duration-300 font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8" stroke-linecap="round" stroke-linejoin="round"/>
              <line x1="21" y1="21" x2="16.65" y2="16.65" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            점검 내역
          </a>
          <a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-red-100 hover:text-red-700 transition duration-300 font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v4m0 4h.01" />
            </svg>
            이슈 관리
          </a>
          <a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-sky-100 hover:text-sky-700 transition duration-300 font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 3v18h18" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 17v-6m4 6v-10m4 10v-4" />
            </svg>
            통계
          </a>
          <a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-200 hover:text-gray-900 transition duration-300 font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.4 15a1.66 1.66 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.66 1.66 0 0 0-1.82-.33 1.66 1.66 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.1a1.66 1.66 0 0 0-1-1.51 1.66 1.66 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.66 1.66 0 0 0 .33-1.82 1.66 1.66 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.1a1.66 1.66 0 0 0 1.51-1 1.66 1.66 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.66 1.66 0 0 0 1.82.33H9a1.66 1.66 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.1a1.66 1.66 0 0 0 1 1.51 1.66 1.66 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.66 1.66 0 0 0-.33 1.82V9a1.66 1.66 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.1a1.66 1.66 0 0 0-1.51 1z" />
            </svg>
            설정
          </a>
        </nav>
    </aside>

    <!-- 메인 컨텐츠 -->
    <main class="flex-1 flex flex-col bg-gray-50 md:ml-64">

      <!-- 헤더 -->
      <header class="bg-white shadow-sm pl-20 md:pl-8 pr-8 py-5 flex items-center justify-between sticky top-0 z-20 w-full">
        <h1 class="text-2xl sm:text-3xl font-extrabold text-gray-700 select-none whitespace-nowrap">
          대시보드
        </h1>

        <!-- 사용자 정보 및 로그아웃 버튼 -->
        <div class="flex items-center space-x-4 sm:space-x-6">
          <div class="flex flex-col text-right">
            <span class="text-sm sm:text-base text-gray-600 font-medium select-text leading-tight">
              홍길동<br class="sm:hidden" />관리자
            </span>
          </div>
          <button
            type="button"
            class="bg-gray-400 text-white text-sm sm:text-base px-2 sm:px-4 py-2 rounded-lg font-semibold hover:bg-gray-700 transition duration-300"
          >
            로그아웃
          </button>
        </div>
      </header>

      <!-- 메인 콘텐츠 -->
      <section class="p-8 space-y-8 overflow-auto">

        <!-- 카드 영역 -->
        <div class="grid grid-cols-2 xs:grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 p-0">
        <div class="group relative rounded-xl shadow-lg p-6 flex flex-col justify-center
                    hover:shadow-2xl hover:scale-105 hover:-translate-y-1 transform transition duration-300
                    bg-indigo-50 hover:bg-indigo-100 max-w-full sm:max-w-[280px] min-h-[140px] cursor-pointer" data-status="all">
          <p class="text-sm text-gray-500 group-hover:text-gray-600 uppercase mb-1 tracking-wide font-semibold text-left">총 사이트 수</p>
          <p id="totalSites" class="text-4xl font-extrabold text-indigo-600 text-left z-10">--</p>

          <svg xmlns="http://www.w3.org/2000/svg" 
              class="absolute bottom-3 right-3 w-10 h-10 text-indigo-600 opacity-30 pointer-events-none select-none" 
              fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 3v18h18" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 17v-6m4 6v-10m4 10v-4" />
          </svg>
        </div>

        <div class="group relative rounded-xl shadow-lg p-6 flex flex-col justify-center
                    hover:shadow-2xl hover:scale-105 hover:-translate-y-1 transform transition duration-300
                    bg-green-50 hover:bg-green-100 max-w-full sm:max-w-[280px] min-h-[140px] cursor-pointer" data-status="완료">
          <p class="text-sm text-gray-500 group-hover:text-gray-600 uppercase mb-1 tracking-wide font-semibold text-left">점검 완료</p>
          <p id="completedChecks" class="text-4xl font-extrabold text-green-600 text-left z-10">--</p>

          <svg xmlns="http://www.w3.org/2000/svg" 
              class="absolute bottom-3 right-3 w-10 h-10 text-green-600 opacity-30 pointer-events-none select-none" 
              fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8" stroke-linecap="round" stroke-linejoin="round"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>

        <div class="group relative rounded-xl shadow-lg p-6 flex flex-col justify-center
                    hover:shadow-2xl hover:scale-105 hover:-translate-y-1 transform transition duration-300
                    bg-orange-50 hover:bg-orange-100 max-w-full sm:max-w-[280px] min-h-[140px] cursor-pointer" data-status="진행 중">
          <p class="text-sm text-gray-500 group-hover:text-gray-600 uppercase mb-1 tracking-wide font-semibold text-left">진행 중</p>
          <p id="ongoingChecks" class="text-4xl font-extrabold text-orange-500 text-left z-10">--</p>

          <svg xmlns="http://www.w3.org/2000/svg" 
              class="absolute bottom-3 right-3 w-10 h-10 text-orange-500 opacity-30 pointer-events-none select-none" 
              fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3" />
            <circle cx="12" cy="12" r="10" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>

        <div class="group relative rounded-xl shadow-lg p-6 flex flex-col justify-center
                    hover:shadow-2xl hover:scale-105 hover:-translate-y-1 transform transition duration-300
                    bg-red-50 hover:bg-red-100 max-w-full sm:max-w-[280px] min-h-[140px] cursor-pointer" data-status="오류">
          <p class="text-sm text-gray-500 group-hover:text-gray-600 uppercase mb-1 tracking-wide font-semibold text-left">이슈 건수</p>
          <p id="issueCount" class="text-4xl font-extrabold text-red-600 text-left z-10">--</p>

          <svg xmlns="http://www.w3.org/2000/svg" 
              class="absolute bottom-3 right-3 w-10 h-10 text-red-600 opacity-30 pointer-events-none select-none" 
              fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v4m0 4h.01" />
          </svg>
        </div>
      </div>

        <!-- 테이블 섹션 -->
        <div class="card">
          <h2 class="text-2xl font-bold text-gray-700 mb-6 select-none">최근 점검 내역</h2>
          <div class="overflow-x-auto">
            <table class="min-w-full text-left text-sm text-gray-700">
              <thead class="bg-gray-100 text-sky-600 font-semibold uppercase tracking-wider">
                <tr>
                  <th class="py-3 px-6">사이트명</th>
                  <th class="py-3 px-6">점검일</th>
                  <th class="py-3 px-6">상태</th>
                  <th class="py-3 px-6">비고</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-b border-gray-200 hover:bg-sky-50 transition-colors cursor-pointer">
                  <td class="py-3 px-6 font-medium">행정안전부</td>
                  <td class="py-3 px-6">2025-08-05</td>
                  <td class="py-3 px-6 text-emerald-600 font-semibold">완료</td>
                  <td class="py-3 px-6">정상</td>
                </tr>
                <tr class="border-b border-gray-200 hover:bg-rose-50 transition-colors cursor-pointer">
                  <td class="py-3 px-6 font-medium">환경부</td>
                  <td class="py-3 px-6">2025-08-04</td>
                  <td class="py-3 px-6 text-rose-600 font-semibold">오류</td>
                  <td class="py-3 px-6">접근성 오류 발견</td>
                </tr>
                <!-- 추가 행 가능 -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- 감각적인 텍스트 박스 -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="card flex flex-col justify-center items-start space-y-2 border border-sky-200 rounded-xl p-6"
            style="background-color: rgba(224, 242, 254, 0.3);">
            <h3 class="text-lg font-semibold text-sky-700">공지사항</h3>
            <p class="text-gray-600">2025-08-06: 정기 점검 예정 안내</p>
        </div>
        <div class="card flex flex-col justify-center items-start space-y-2 border border-yellow-200 rounded-xl p-6"
            style="background-color: rgba(255, 255, 223, 0.3);">
            <h3 class="text-lg font-semibold text-yellow-600">긴급 알림</h3>
            <p class="text-gray-600">서버 점검으로 인한 서비스 일시 중단</p>
        </div>
        <div class="card flex flex-col justify-center items-start space-y-2 border border-rose-200 rounded-xl p-6"
            style="background-color: rgba(255, 223, 223, 0.3);">
            <h3 class="text-lg font-semibold text-rose-600">이슈 현황</h3>
            <p id="issueStatusText" class="text-gray-600">이슈 7건 처리 중</p>
        </div>
        </div>

      </section>

    </main>
  </div>

  <script>
  const sidebarToggle = document.getElementById('sidebarToggle');
  const sidebar = document.getElementById('sidebar');

  sidebarToggle.addEventListener('click', () => {
    sidebar.classList.toggle('-translate-x-full');
  });

  // API 호출 및 데이터 전역 저장용
  let inspectionData = [];

  // 현재 필터 상태
  let currentFilter = 'all';

  // 테이블 렌더링 함수 (필터 상태에 따라 필터링)
  function renderTable(filterStatus = 'all') {
    const tbody = document.querySelector('table tbody');
    tbody.innerHTML = '';

    const filtered = filterStatus === 'all'
      ? inspectionData
      : inspectionData.filter(item => item.status === filterStatus);

    filtered.forEach(item => {
      const tr = document.createElement('tr');

      const statusClass = item.status === '완료' ? 'emerald' :
                          item.status === '진행 중' ? 'orange' :
                          item.status === '오류' ? 'rose' : 'gray';

      const bgHoverClass = item.status === '완료' ? 'sky' :
                           item.status === '진행 중' ? 'orange' :
                           item.status === '오류' ? 'rose' : 'gray';

      tr.className = `border-b border-gray-200 cursor-pointer hover:bg-${bgHoverClass}-50 transition-colors`;

      tr.innerHTML = `
        <td class="py-3 px-6 font-medium">${item.site}</td>
        <td class="py-3 px-6">${item.date}</td>
        <td class="py-3 px-6 font-semibold text-${statusClass}-600">${item.status}</td>
        <td class="py-3 px-6">${item.remark}</td>
      `;

      tbody.appendChild(tr);
    });
  }

  // 카드 숫자 업데이트
  function updateCardNumbers() {
    const totalSites = new Set(inspectionData.map(item => item.site)).size;
    const completedChecks = inspectionData.filter(item => item.status === '완료').length;
    const ongoingChecks = inspectionData.filter(item => item.status === '진행 중').length;
    const issueCount = inspectionData.filter(item => item.status === '오류').length;

    document.getElementById('totalSites').textContent = totalSites;
    document.getElementById('completedChecks').textContent = completedChecks;
    document.getElementById('ongoingChecks').textContent = ongoingChecks;
    document.getElementById('issueCount').textContent = issueCount;

    document.getElementById('issueStatusText').textContent = `이슈 ${issueCount}건 처리 중`;
  }

  // 카드 선택 강조 표시 함수
  function highlightSelectedCard(selectedStatus) {
    const cards = document.querySelectorAll('[data-status]');
    cards.forEach(card => {
      if (card.dataset.status === selectedStatus) {
        card.classList.add('border-indigo-500');
        card.classList.remove('border-transparent');
      } else {
        card.classList.remove('border-indigo-500');
        card.classList.add('border-transparent');
      }
    });
  }

  // 카드 클릭 이벤트 등록
  function setupCardClicks() {
    const cards = document.querySelectorAll('[data-status]');
    cards.forEach(card => {
      card.addEventListener('click', () => {
        const status = card.dataset.status;
        currentFilter = status;
        renderTable(status);
        highlightSelectedCard(status);
      });
    });
  }

  // API 호출 후 초기화
  async function loadInspectionData() {
    const response = await fetch('/api/inspections');
    inspectionData = await response.json();

    updateCardNumbers();
    renderTable(currentFilter);
    highlightSelectedCard(currentFilter);
  }

  // 초기 실행
  loadInspectionData();
  setupCardClicks();

</script>
</body>
</html>